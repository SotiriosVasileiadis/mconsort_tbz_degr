cov_mat <- read.table("coverage_new.tsv", sep = "\t")
View(cov_mat)
cov_mat <- read.table("coverage_new.tsv", sep = "\t", header = T)
View(cov_mat)
system('cd ../dastool/dastoolout_DASTool_bins_ammened_with_opera_contig_395_SV; grep "^>" *.fa | perl -pe "s/ .+//" | perl -pe "s/\.fa:>/\t/g"')
bin_table <- read.table("../dastool/contig_membership.txt")
View(bin_table)
View(bin_table)
colnames(bin_table) <- c("binID","contigID")
colnames(cov_mat)
cov_mat$contig[1:10]
View(bin_table)
# merge the tables
fin_mat <- merge(cov_mat, bin_table, by.x = "contig", by.y = "contigID")
View(fin_mat)
View(fin_mat)
merger <- merge(cov_mat, bin_table, by.x = "contig", by.y = "contigID")
merger <- merger[,grep("SRR|contig|binID")]
merger <- merger[,grep("SRR|contig|binID",colnames(merger))]
merger_fin <- merger[,grep("SRR|contig|binID",colnames(merger))]
# calculate the mean coverage per bin for each of the short read SRR datasets
aggregated <- aggregate(merger_fin[,grep("SRR",colnames(merger_fin))], by = list(merger_fin$binID), FUN = mean)
head(aggregated)
aggregated
aggregated_fin <- data.frame(aggregated[,grep("SRR",colnames(aggregated))],row.names = aggregated$Group.1)
head(aggregated_fin)
aggregated_RA <- decostand(aggregated_fin, MARGIN = 2, method = "total")
# obtain the relative abundances of the bins
library(vegan)
aggregated_RA <- decostand(aggregated_fin, MARGIN = 2, method = "total")
View(aggregated_RA)
aggregated_RA <- round(100*decostand(aggregated_fin, MARGIN = 2, method = "total"),1)
aggregated_RA
aggregated_RA <- round(100*decostand(aggregated_fin, MARGIN = 2, method = "total"),3)
write.table(aggregated_RA, file = "bin_RA.txt", sep = "\t", quote = F, col.names = NA)
